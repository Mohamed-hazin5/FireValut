{"ast":null,"code":"import { StorageAction } from '@aws-amplify/core/internals/utils';\nimport '@smithy/md5-js';\nimport '@aws-amplify/core/internals/aws-client-utils';\nimport '../../utils/client/runtime/s3TransferHandler/fetch.mjs';\nimport 'fast-xml-parser';\nimport '../../utils/client/runtime/s3TransferHandler/xhr.mjs';\nimport 'buffer';\nimport { deleteFolderContents } from '../../utils/deleteFolderContents.mjs';\nimport { resolveS3ConfigAndInput } from '../../utils/resolveS3ConfigAndInput.mjs';\nimport { resolveFinalKey } from '../../utils/resolveFinalKey.mjs';\nimport { CanceledError } from '../../../../errors/CanceledError.mjs';\nimport '../../../../errors/types/validation.mjs';\nimport '../../../../utils/logger.mjs';\nimport { validateBucketOwnerID } from '../../utils/validateBucketOwnerID.mjs';\nimport { validateRemovePath } from '../../utils/validateRemovePath.mjs';\nimport { validateStorageOperationInput } from '../../utils/validateStorageOperationInput.mjs';\nimport { STORAGE_INPUT_KEY } from '../../utils/constants.mjs';\nimport { isPathFolder } from '../../utils/isPathFolder.mjs';\nimport { createAbortableTask } from '../../utils/createAbortableTask.mjs';\nimport '../../utils/client/s3data/base.mjs';\nimport '../../utils/client/s3data/getObject.mjs';\nimport '../../utils/client/s3data/listObjectsV2.mjs';\nimport '../../utils/client/s3data/putObject.mjs';\nimport '../../utils/client/s3data/createMultipartUpload.mjs';\nimport '../../utils/client/s3data/uploadPart.mjs';\nimport '../../utils/client/s3data/completeMultipartUpload.mjs';\nimport '../../utils/client/s3data/listParts.mjs';\nimport '../../utils/client/s3data/abortMultipartUpload.mjs';\nimport '../../utils/client/s3data/copyObject.mjs';\nimport '../../utils/client/s3data/headObject.mjs';\nimport { deleteObject } from '../../utils/client/s3data/deleteObject.mjs';\nimport '../../utils/client/s3data/deleteObjects.mjs';\nimport { getStorageUserAgentValue } from '../../utils/userAgent.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nfunction remove(amplify, input) {\n  return createAbortableTask(executeRemove(amplify, input));\n}\nconst executeRemove = (amplify, input) => async abortController => {\n  try {\n    const {\n      s3Config,\n      keyPrefix,\n      bucket,\n      identityId\n    } = await resolveS3ConfigAndInput(amplify, input);\n    const {\n      inputType,\n      objectKey\n    } = validateStorageOperationInput(input, identityId);\n    validateBucketOwnerID(input.options?.expectedBucketOwner);\n    const finalKey = resolveFinalKey(inputType, objectKey, keyPrefix);\n    validateRemovePath(finalKey);\n    const isFolder = finalKey.endsWith('/') || (await isPathFolder({\n      s3Config,\n      bucket,\n      key: finalKey,\n      expectedBucketOwner: input.options?.expectedBucketOwner\n    }));\n    if (isFolder) {\n      return deleteFolderContents({\n        s3Config,\n        bucket,\n        folderKey: finalKey,\n        expectedBucketOwner: input.options?.expectedBucketOwner,\n        onProgress: input.options?.onProgress,\n        abortSignal: abortController.signal\n      });\n    } else {\n      if (abortController.signal.aborted) {\n        throw new CanceledError({\n          message: 'Operation was cancelled'\n        });\n      }\n      await deleteObject({\n        ...s3Config,\n        userAgentValue: getStorageUserAgentValue(StorageAction.Remove),\n        abortSignal: abortController.signal\n      }, {\n        Bucket: bucket,\n        Key: finalKey,\n        ExpectedBucketOwner: input.options?.expectedBucketOwner\n      });\n      const result = inputType === STORAGE_INPUT_KEY ? {\n        key: objectKey\n      } : {\n        path: objectKey\n      };\n      return result;\n    }\n  } catch (error) {\n    if (abortController.signal.aborted) {\n      throw new CanceledError({\n        message: 'Operation was cancelled'\n      });\n    }\n    throw error;\n  }\n};\nexport { remove };","map":{"version":3,"names":["remove","amplify","input","createAbortableTask","executeRemove","abortController","s3Config","keyPrefix","bucket","identityId","resolveS3ConfigAndInput","inputType","objectKey","validateStorageOperationInput","validateBucketOwnerID","options","expectedBucketOwner","finalKey","resolveFinalKey","validateRemovePath","isFolder","endsWith","isPathFolder","key","deleteFolderContents","folderKey","onProgress","abortSignal","signal","aborted","CanceledError","message","deleteObject","userAgentValue","getStorageUserAgentValue","StorageAction","Remove","Bucket","Key","ExpectedBucketOwner","result","STORAGE_INPUT_KEY","path","error"],"sources":["/Users/mohamedhazin/Desktop/filevalut/frontend/node_modules/@aws-amplify/storage/src/providers/s3/apis/internal/remove.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { StorageAction } from '@aws-amplify/core/internals/utils';\nimport { deleteFolderContents, isPathFolder, resolveFinalKey, resolveS3ConfigAndInput, validateBucketOwnerID, validateRemovePath, validateStorageOperationInput, } from '../../utils';\nimport { deleteObject } from '../../utils/client/s3data';\nimport { getStorageUserAgentValue } from '../../utils/userAgent';\nimport { STORAGE_INPUT_KEY } from '../../utils/constants';\nimport { createAbortableTask } from '../../utils/createAbortableTask';\nimport { CanceledError } from '../../../../errors/CanceledError';\nexport function remove(amplify, input) {\n    return createAbortableTask(executeRemove(amplify, input));\n}\nconst executeRemove = (amplify, input) => async (abortController) => {\n    try {\n        const { s3Config, keyPrefix, bucket, identityId } = await resolveS3ConfigAndInput(amplify, input);\n        const { inputType, objectKey } = validateStorageOperationInput(input, identityId);\n        validateBucketOwnerID(input.options?.expectedBucketOwner);\n        const finalKey = resolveFinalKey(inputType, objectKey, keyPrefix);\n        validateRemovePath(finalKey);\n        const isFolder = finalKey.endsWith('/') ||\n            (await isPathFolder({\n                s3Config,\n                bucket,\n                key: finalKey,\n                expectedBucketOwner: input.options?.expectedBucketOwner,\n            }));\n        if (isFolder) {\n            return deleteFolderContents({\n                s3Config,\n                bucket,\n                folderKey: finalKey,\n                expectedBucketOwner: input.options?.expectedBucketOwner,\n                onProgress: input.options?.onProgress,\n                abortSignal: abortController.signal,\n            });\n        }\n        else {\n            if (abortController.signal.aborted) {\n                throw new CanceledError({ message: 'Operation was cancelled' });\n            }\n            await deleteObject({\n                ...s3Config,\n                userAgentValue: getStorageUserAgentValue(StorageAction.Remove),\n                abortSignal: abortController.signal,\n            }, {\n                Bucket: bucket,\n                Key: finalKey,\n                ExpectedBucketOwner: input.options?.expectedBucketOwner,\n            });\n            const result = inputType === STORAGE_INPUT_KEY\n                ? { key: objectKey }\n                : { path: objectKey };\n            return result;\n        }\n    }\n    catch (error) {\n        if (abortController.signal.aborted) {\n            throw new CanceledError({ message: 'Operation was cancelled' });\n        }\n        throw error;\n    }\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAQO,SAASA,MAAMA,CAACC,OAAO,EAAEC,KAAK,EAAE;EACnC,OAAOC,mBAAmB,CAACC,aAAa,CAACH,OAAO,EAAEC,KAAK,CAAC,CAAC;AAC7D;AACA,MAAME,aAAa,GAAGA,CAACH,OAAO,EAAEC,KAAK,KAAK,MAAOG,eAAe,IAAK;EACjE,IAAI;IACA,MAAM;MAAEC,QAAQ;MAAEC,SAAS;MAAEC,MAAM;MAAEC;IAAU,CAAE,GAAG,MAAMC,uBAAuB,CAACT,OAAO,EAAEC,KAAK,CAAC;IACjG,MAAM;MAAES,SAAS;MAAEC;IAAS,CAAE,GAAGC,6BAA6B,CAACX,KAAK,EAAEO,UAAU,CAAC;IACjFK,qBAAqB,CAACZ,KAAK,CAACa,OAAO,EAAEC,mBAAmB,CAAC;IACzD,MAAMC,QAAQ,GAAGC,eAAe,CAACP,SAAS,EAAEC,SAAS,EAAEL,SAAS,CAAC;IACjEY,kBAAkB,CAACF,QAAQ,CAAC;IAC5B,MAAMG,QAAQ,GAAGH,QAAQ,CAACI,QAAQ,CAAC,GAAG,CAAC,KAClC,MAAMC,YAAY,CAAC;MAChBhB,QAAQ;MACRE,MAAM;MACNe,GAAG,EAAEN,QAAQ;MACbD,mBAAmB,EAAEd,KAAK,CAACa,OAAO,EAAEC;IACpD,CAAa,CAAC,CAAC;IACP,IAAII,QAAQ,EAAE;MACV,OAAOI,oBAAoB,CAAC;QACxBlB,QAAQ;QACRE,MAAM;QACNiB,SAAS,EAAER,QAAQ;QACnBD,mBAAmB,EAAEd,KAAK,CAACa,OAAO,EAAEC,mBAAmB;QACvDU,UAAU,EAAExB,KAAK,CAACa,OAAO,EAAEW,UAAU;QACrCC,WAAW,EAAEtB,eAAe,CAACuB;MAC7C,CAAa,CAAC;IACN,OACK;MACD,IAAIvB,eAAe,CAACuB,MAAM,CAACC,OAAO,EAAE;QAChC,MAAM,IAAIC,aAAa,CAAC;UAAEC,OAAO,EAAE;QAAyB,CAAE,CAAC;MACnE;MACA,MAAMC,YAAY,CAAC;QACf,GAAG1B,QAAQ;QACX2B,cAAc,EAAEC,wBAAwB,CAACC,aAAa,CAACC,MAAM,CAAC;QAC9DT,WAAW,EAAEtB,eAAe,CAACuB;MAC7C,CAAa,EAAE;QACCS,MAAM,EAAE7B,MAAM;QACd8B,GAAG,EAAErB,QAAQ;QACbsB,mBAAmB,EAAErC,KAAK,CAACa,OAAO,EAAEC;MACpD,CAAa,CAAC;MACF,MAAMwB,MAAM,GAAG7B,SAAS,KAAK8B,iBAAA,GACvB;QAAElB,GAAG,EAAEX;MAAS,IAChB;QAAE8B,IAAI,EAAE9B;MAAS,CAAE;MACzB,OAAO4B,MAAM;IACjB;EACJ,EACA,OAAOG,KAAK,EAAE;IACV,IAAItC,eAAe,CAACuB,MAAM,CAACC,OAAO,EAAE;MAChC,MAAM,IAAIC,aAAa,CAAC;QAAEC,OAAO,EAAE;MAAyB,CAAE,CAAC;IACnE;IACA,MAAMY,KAAK;EACf;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}